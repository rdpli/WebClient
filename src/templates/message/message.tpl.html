<div class="messageComponent pt1">
    <article class="message message-container" ng-class="getClassNames(message, marked)">

        <div class="message-header flex cursor-pointer message-summary" data-toggle-message>

            <div class="summary-left">
                <div class="meta inline-flex">

                    <icon class="message-iconInfo" data-name="reply" data-if-is="replied"></icon>
                    <icon class="message-iconInfo" data-name="reply-all" data-if-is="repliedall"></icon>
                    <icon class="message-iconInfo" data-name="forward" data-if-is="forwarded"></icon>

                    <div class="contact message-contact flex">

                        <div class="from message-contact-from mr0-5">
                            <span translate translate-context="Message sender label" translate>From</span>:
                        </div>

                        <div
                            class="from-value"
                            pt-tooltip="{{ ::message.Sender | contact:'Name' }} {{ ::message.Sender | contact:'Address' }}">
                            <strong>{{ ::message.Sender | contact:'Name' }}</strong>
                            <em>{{ ::message.Sender | contact:'Address' }}</em>
                        </div>

                        <encryption-status class="encryptionStatus"></encryption-status>

                        <message-address-action-menu
                            ng-if="message.expand"
                            data-message="message"
                            data-email="message.Sender"
                            ></message-address-action-menu>
                    </div>
                </div>
            </div>

            <div class="summary-right mlauto flex flex-column">
                <div class="inline-flex mlauto flex-items-center">

                    <icon
                        ng-if="message.NumAttachments && !message.expand"
                        data-name="attach"
                        class="mr0-5"></icon>

                    <folders-message  ng-if="!message.expand"></folders-message>

                    <div class="labels message-summary-labels mr0-5" ng-if="!message.expand">
                        <labels-element
                            data-element="message"
                            class="message-summary-labels-list flex-nowrap"></labels-element>
                    </div>

                    <time
                        class="time-machine"
                        data-time-refreshed="{{ ::message.Time }}"
                        data-time-filter="messageTime"
                        data-time-interval="30000"></time>

                    <pt-star
                        data-model="message"
                        class="singleStar ml0-5"
                        ng-if="!message.expand"
                        data-pt-star-type="message"></pt-star>
               </div>
            </div>
        </div>

        <div ng-if="message.expand" class="message-expand-wrapper relative">

            <div class="message-header">

                <div ng-if="message.toggleDetails" class="mb0-5">
                    <div class="flex flex-items-start flex-nowrap">
                        <div class="flex-item-fluid">
                            <time class="time-readable">{{ ::message.Time | localReadableTime }}</time>
                            <div class="recipients-details-size"><span translate-context="Label for the message size when displaying email details" translate>Size:</span> {{ ::message.Size | bytes }}</div>
                        </div>

                        <div class="flex flex-items-center flex-item-noshrink flex-justify-end message-expand-right-info">
                            <icon
                                ng-if="message.NumAttachments"
                                data-name="attach"
                                class="mr0-5"></icon>

                            <div class="labels message-summary-labels">
                                <labels-element
                                    data-button="remove"
                                    data-element="message"
                                    class="message-summary-labels-list flex-nowrap"></labels-element>
                                </div>

                                <div class="location message-summary-folder inline-flex folders">
                                    <folders-message></folders-message>
                                </div>

                                <pt-star
                                    data-model="message"
                                    class="singleStar ml0-5"
                                    data-pt-star-type="message"></pt-star>
                            </div>
                    </div>

                </div>

                <div class="recipients-summary flex mb0-5">
                    <span class="flex flex-item-fluid ellipsis pr1">
                        <span
                            class="opacity-50 flex-self-vcenter container-to"
                            translate-context="Message recipient label"
                            translate>To:</span>

                        <span
                            class="recipients-summary-label"
                            ng-repeat="email in recipients() track by $id(email)"
                            title="{{ ::email | contact:'Address' }}">{{::email | contact: 'Name': true | nameRecipient}}</span>

                        <span
                            ng-if="::noRecipients()"
                            class="recipients-summary-label"
                            translate-context="No recipients to display in the message header"
                            translate>Undisclosed Recipients</span>
                    </span>
                    <div class="inline-flex flex-items-center flex-item-noshrink flex-justify-end message-expand-right-info">
                        <icon
                            ng-if="message.NumAttachments"
                            data-name="attach"
                            class="mr0-5"></icon>

                        <div class="labels message-summary-labels">
                            <labels-element
                                data-button="remove"
                                data-element="message"
                                class="message-summary-labels-list flex-nowrap"></labels-element>
                        </div>

                        <div class="location message-summary-folder inline-flex folders">
                            <folders-message></folders-message>
                        </div>

                        <pt-star
                            data-model="message"
                            class="singleStar ml0-5"
                            data-pt-star-type="message"></pt-star>
                    </div>
                </div>

                <div class="recipients-details">
                    <message-contacts
                        class="recipients-details-toGroup mb0-5"
                        ng-if="message.ToList.length"
                        data-model="toList"
                        data-list="To"
                        data-message="message"
                    ></message-contacts>

                    <message-contacts
                        class="recipients-details-ccGroup mb0-5"
                        ng-if="message.CCList.length"
                        data-model="ccList"
                        data-list="CC"
                        data-message="message"
                        ></message-contacts>

                    <message-contacts
                        class="recipients-details-bccGroup"
                        ng-if="message.BCCList.length"
                        data-model="bccList"
                        data-list="BCC"
                        data-message="message"
                    ></message-contacts>

                    <div class="encrypted-subject" ng-if="message.encryptedSubject">
                        <i
                            class="fa fa-lock encrypted-subject-icon"
                            pt-tooltip-translate="Subject is end-to-end encrypted"
                            pt-tooltip-translate-context="Tooltip"></i>
                        <span
                            translate
                            translate-context="Title"
                            class="header-name">Subject</span>
                        <span> {{ ::message.encryptedSubject }}</span>
                    </div>
                </div>

                <div class="action-row flex flex-items-center flex-spacebetween">

                    <button class="toggleDetails link mb0-5" data-action-message="toggleDetails">
                        <span class="toggleDetails-label-show" translate translate-context="Action">Show details</span>
                        <span class="toggleDetails-label-hide" translate translate-context="Action">Hide details</span>
                    </button>

                    <div class="actions flex" ng-if="message.decrypting === false">

                        <div class="pm-group-buttons mr1 mb0-5">
                            <filter-button
                                data-message="message"
                                class="pm_buttons flex pm-group-button pm-button pm-button--for-icon"></filter-button>

                            <folder-selector-dropdown
                                data-message="message"
                                class="pm_buttons flex pm-group-button pm-button pm-button--for-icon"></folder-selector-dropdown>

                            <label-selector-dropdown
                                data-message="message"
                                class="pm_buttons flex pm-group-button pm-button pm-button--for-icon"></label-selector-dropdown>

                            <message-options class="flex"></message-options>
                        </div>

                        <div class="pm-group-buttons mb0-5">
                            <button
                                class="pm-group-button inline-flex pm-button pm-button--for-icon dropdown-actions-nowrap-reply"
                                data-action-compose="::message"
                                data-action-compose-type="reply"
                                pt-tooltip-translate="Reply"
                                pt-tooltip-translate-context="Action"
                                tabindex="0">
                                <icon data-name="reply" class=" mauto"></icon>
                                <span class="sr-only" translate-context="Action" translate>Reply</span>
                            </button>

                            <button
                                class="pm-group-button inline-flex pm-button pm-button--for-icon dropdown-actions-nowrap-replyall"
                                data-action-compose="::message"
                                data-action-compose-type="replyall"
                                pt-tooltip-translate="Reply all"
                                pt-tooltip-translate-context="Action"
                                tabindex="0">
                                <icon data-name="reply-all" class=" mauto"></icon>
                                <span class="sr-only" translate-context="Action" translate>Reply all</span>
                            </button>

                            <button
                                class="pm-group-button inline-flex pm-button pm-button--for-icon dropdown-actions-nowrap-forward"
                                data-action-compose="::message"
                                data-action-compose-type="forward"
                                pt-tooltip-translate="Forward"
                                pt-tooltip-translate-context="Action"
                                tabindex="0">
                                <icon data-name="forward"  class=" mauto"></icon>
                                <span class="sr-only" translate-context="Action" translate>Forward</span>
                            </button>
                        </div>
                    </div>
                </div>

                <message-extra class="mt0-5"></message-extra>
            </div>

            <events-attachments data-model="message"></events-attachments>

            <div class="message-content frame message-frame" data-embedded-img-loader data-inject-message-media>
                <loader-tag ng-if="message.decrypting === true"></loader-tag>
                <div
                    class="bodyDecrypted email message-body-container"
                    ng-class="{'plain': message.isPlain}"
                    render-message-body
                    ng-if="message.viewMode === 'html' && !message.failedDecryption"
                    toggle-blockquote
                    scroll="true"></div>

                <pre
                    class="email message-body-container"
                    ng-if="message.viewMode === 'plain' || message.failedDecryption">{{message.plainText()}}</pre>
            </div>

            <list-attachments ng-if="message.Attachments.length" data-model="message"></list-attachments>
        </div>
        <div class="clear"></div>

    </article>

</div>
